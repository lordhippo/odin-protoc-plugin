# odin-protoc-plugin
![build status](https://github.com/lordhippo/odin-protoc-plugin/actions/workflows/build.yml/badge.svg)
![c++ checks](https://github.com/lordhippo/odin-protoc-plugin/actions/workflows/cpp-checks.yml/badge.svg)

A Protobuf compiler [plugin](https://protobuf.dev/reference/other/#plugins) for Odin. It should be used with the runtime [odin-protobuf](https://github.com/lordhippo/odin-protobuf) library.

## Usage
Put this plugin's binary next to a [Protobuf Compiler (protoc)](https://github.com/protocolbuffers/protobuf) or in the PATH. Then use `--odin_out` argument to generate Odin files.

## Sample output
For this example proto file:

```proto
syntax = "proto3";

package examples;

enum Example_Enum {
	None = 0;
	First = 1;
	Second = 2;
}

message Inner_Message {
	float number = 1;
	string text = 2;
}

message Example_Message {
	int32 number = 1;
	string text = 2;
	Inner_Message inner = 3;
	repeated int32 arr_num = 4 [packed = false];
	repeated string arr_text = 5;
	repeated Inner_Message arr_inner = 6;
	Example_Enum my_enum = 7;
	
	oneof test_oneof {
		string oneof_name = 8;
		Inner_Message oneof__message = 9;
	}
}

```

This plugin will generate this Odin output:
```odin
// Auto-generated by odin-protoc-plugin (https://github.com/lordhippo/odin-protoc-plugin)
// protoc version: 4.25.3
// Use with the runtime odin-protobuf library (https://github.com/lordhippo/odin-protobuf)

package proto_examples

Inner_Message :: struct {
  number : f32 `id:"1" type:"2"`,
  text : string `id:"2" type:"9"`,
}

Example_Message :: struct {
  number : i32 `id:"1" type:"5"`,
  text : string `id:"2" type:"9"`,
  inner : Inner_Message `id:"3" type:"11"`,
  arr_num : [](i32) `id:"4" type:"5"`,
  arr_text : [](string) `id:"5" type:"9"`,
  arr_inner : [](Inner_Message) `id:"6" type:"11"`,
  my_enum : Example_Enum `id:"7" type:"14"`,

  test_oneof: struct #raw_union {
    oneof_name : string `id:"8" type:"9"`,
    oneof__message : Inner_Message `id:"9" type:"11"`,
  }
}

Example_Enum :: enum {
  None = 0,
  First = 1,
  Second = 2,
}

```

## Missing features
- [Default values](https://github.com/lordhippo/odin-protoc-plugin/issues/5)
- [Dependencies](https://github.com/lordhippo/odin-protoc-plugin/issues/7)
- [Native Odin `map` support](https://github.com/lordhippo/odin-protoc-plugin/issues/3)
- [Oneof check](https://github.com/lordhippo/odin-protoc-plugin)
